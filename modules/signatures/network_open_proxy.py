# Copyright (C) 2020 ditekshen
#
# This program is free software: you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.
#
# This program is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with this program.  If not, see <http://www.gnu.org/licenses/>.

from lib.cuckoo.common.abstracts import Signature

# List downloaded by DLInjector03


class NetworkOpenProxy(Signature):
    name = "network_open_proxy"
    description = "Connects to open proxy IP address"
    severity = 3
    categories = ["network"]
    authors = ["ditekshen"]
    minimum = "1.3"
    evented = True
    ttps = ["T1090"]  # MITRE v6,7,8

    def run(self):
        ip_indicators = [
            "3.217.181.204",
            "5.2.200.203",
            "5.39.17.96",
            "5.39.87.119",
            "5.133.27.11",
            "5.133.27.62",
            "11.37.41.0",
            "18.235.220.172",
            "20.199.88.72",
            "34.241.132.17",
            "35.246.142.152",
            "37.130.26.96",
            "45.155.37.218",
            "46.167.234.141",
            "46.167.237.48",
            "46.167.238.50",
            "46.167.238.253",
            "51.68.82.156",
            "51.91.157.66",
            "51.91.210.72",
            "51.158.71.45",
            "51.195.203.253",
            "54.197.119.29",
            "62.80.253.175",
            "77.70.35.87",
            "77.242.24.189",
            "78.61.40.137",
            "78.83.12.181",
            "78.130.197.224",
            "78.158.19.196",
            "79.106.246.174",
            "79.235.246.50",
            "80.90.92.15",
            "80.91.118.61",
            "80.103.75.233",
            "80.211.23.121",
            "81.198.218.209",
            "81.218.45.154",
            "82.135.136.132",
            "82.223.21.37",
            "83.40.67.164",
            "83.112.113.195",
            "85.14.119.9",
            "85.119.150.44",
            "87.121.49.238",
            "87.252.227.188",
            "88.81.91.103",
            "88.146.204.49",
            "88.209.196.109",
            "89.133.95.177",
            "91.82.132.161",
            "91.90.236.239",
            "91.121.75.132",
            "91.143.215.206",
            "91.144.95.163",
            "91.235.254.255",
            "93.86.244.71",
            "93.125.105.181",
            "94.42.176.35",
            "94.42.177.24",
            "94.154.16.166",
            "94.154.17.67",
            "94.154.19.218",
            "94.154.21.179",
            "94.154.22.117",
            "94.157.106.216",
            "95.111.91.50",
            "109.69.211.52",
            "109.72.48.132",
            "109.72.103.122",
            "109.183.247.131",
            "109.185.185.24",
            "109.198.1.197",
            "109.248.222.215",
            "134.19.171.79",
            "134.19.171.146",
            "134.19.174.56",
            "134.122.93.93",
            "142.93.140.53",
            "152.228.163.151",
            "157.90.248.6",
            "165.16.112.149",
            "165.16.112.197",
            "165.22.81.30",
            "165.227.129.165",
            "165.227.173.87",
            "178.18.241.184",
            "178.32.41.167",
            "178.48.68.61",
            "178.115.228.227",
            "178.128.143.54",
            "178.219.117.104",
            "178.219.118.206",
            "178.219.122.103",
            "185.25.249.118",
            "185.57.228.6",
            "185.79.241.38",
            "185.126.228.108",
            "185.131.61.89",
            "185.140.100.128",
            "185.140.101.85",
            "185.140.101.241",
            "185.140.102.165",
            "185.140.102.214",
            "185.144.73.2",
            "185.144.73.66",
            "185.144.73.95",
            "185.144.75.27",
            "185.144.75.97",
            "185.154.239.15",
            "185.157.92.9",
            "185.172.84.176",
            "185.176.137.130",
            "185.214.200.111",
            "185.214.201.67",
            "185.214.201.169",
            "185.216.163.134",
            "185.230.105.134",
            "188.26.122.229",
            "188.117.216.237",
            "193.86.24.146",
            "193.106.231.145",
            "193.150.77.64",
            "193.150.77.78",
            "193.209.254.132",
            "195.144.21.185",
            "195.235.90.29",
            "213.149.137.24",
            "213.166.70.157",
            "213.238.180.113",
            "217.182.239.121",
        ]

        for indicator in ip_indicators:
            if self.check_ip(pattern=indicator):
                self.data.append({"ip": indicator})
                return True

        return False
