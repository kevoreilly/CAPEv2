{% load generic_tags %}
{% load analysis_tags %}

<div class="card bg-dark border-secondary mb-3">
    <div class="card-header border-secondary">
        <h5 class="mb-0 text-white"><i class="fas fa-sitemap mr-2 text-info"></i> Process Tree</h5>
    </div>
    <div class="card-body">
        <ul class="list-unstyled mb-0" style="font-family: monospace;">
        {% for process in behavior.processtree|proctreetolist %}
            {% if process.startchildren %}
              <ul class="pl-4 border-left border-secondary ml-2">
            {% elif process.endchildren %}
              </ul>
            {% else %}
              <li class="mb-1">
                <i class="fas fa-arrow-right text-muted mr-1"></i>
                <strong><a href="javascript:show_tab('process_{{process.pid}}');" class="text-info">{{process.name}}</a></strong> 
                <span class="text-muted ml-1">({{process.pid}})</span>
                {% if process.commandline %}
                    <span class="text-light small ml-2">{{ process.commandline }}</span>
                {% endif %}
                {% if detections2pid|get_detection_by_pid:process.pid %}
                    <span class="badge badge-danger ml-2">{{ detections2pid|get_detection_by_pid:process.pid }}</span>
                {% endif %}
             </li>
            {% endif %}
        {% endfor %}
        </ul>
    </div>
</div>
