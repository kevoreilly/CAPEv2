<section id="domains">
    <div class="card bg-dark border-secondary">
        <div class="card-header border-secondary">
            <h5 class="mb-0 text-white"><i class="fas fa-globe me-2 text-info"></i>DNS Requests</h5>
        </div>
        {% if network.dns %}
            <div class="card-body">
                <table class="table table-dark table-striped table-bordered" style="width: 100%;margin-left: auto;margin-right: auto;">
                    <tr>
                        <th>Name</th>
                        <th>Response</th>
                        <th>Post-Analysis Lookup</th>
                        {% if settings.NETWORK_PROC_MAP %} <th>Process Name (PID)</th> {% endif %}
                    </tr>
                    {% for p in network.dns %}
                        <tr>
                        <td>{{p.request}} <a href="https://www.virustotal.com/gui/domain/{{p.request}}/detection">[VT]</a>
                        {% if config.display_et_portal %}
                        <a href="https://threatintel.proofpoint.com/search?q={{p.request}}" target="_blank">[ET]</a>
                        {% endif %}
                        {% if config.display_pt_portal %}
                        <a href="https://www.passivetotal.org/passive/{{p.request}}" target="_blank">[PT]</a>
                        {% endif %}
                        </td>
                            <td>
                                {% for a in p.answers %}
                                    {{a.type}} {{a.data|linebreaksbr}}
                                    {% if a.type != "NXDOMAIN" %}
                                        {% if a.type == "CNAME" %}
                                        <a href="https://www.virustotal.com/gui/domain/{{a.data}}/detection">[VT]</a>
                                        {% else %}
                                        <a href="https://www.virustotal.com/gui/ip-address/{{a.data}}/detection">[VT]</a>
                                        {% endif %}
                                        {% if config.display_et_portal %}
                                        <a href="https://threatintel.proofpoint.com/search?q={{a.data}}" target="_blank">[ET]</a>
                                        {% endif %}
                                        {% if config.display_pt_portal %}
                                        <a href="https://www.passivetotal.org/passive/{{a.data}}" target="_blank">[PT]</a>
                                        {% endif %}
                                    {% endif %}
                                    {% if not forloop.last %}
                                        <br/>
                                    {% endif %}
                                {% endfor %}
                            </td>
                            <td>{% if domainlookups and domainlookups|get_item:p.request %}
                                {{ domainlookups|get_item:p.request }}
                                <a href="https://www.virustotal.com/gui/ip-address/{{domainlookups|get_item:p.request}}/detection">[VT]</a>
                                {% if config.display_et_portal %}
                                <a href="https://threatintel.proofpoint.com/search?q={{domainlookups|get_item:p.request}}" target="_blank">[ET]</a>
                                {% endif %}
                                {% if config.display_pt_portal %}
                                <a href="https://www.passivetotal.org/passive/{{domainlookups|get_item:p.request}}" target="_blank">[PT]</a>
                                {% endif %}
                                {% endif %}
                            </td>
                            {% if settings.NETWORK_PROC_MAP %}
                                <td>
                                    {% if p.process_name %}
                                        {{ p.process_name }}{% if p.process_id %} ({{ p.process_id }}){% endif %}
                                    {% else %}
                                        -
                                    {% endif %}
                                </td>
                            {% endif %}
                        </tr>
                    {% endfor %}
                </table>
            </div>
        {% else %}
            <div class="card-body">
                <div class="alert alert-info">No domains contacted.</div>
            </div>
        {% endif %}
    </div>
</section>
