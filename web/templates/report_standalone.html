{% extends "base.html" %}
{% block content %}
<div class="container-fluid">
    <ul class="nav nav-tabs" id="reportTabs" role="tablist">
        <li class="nav-item">
            <a class="nav-link active" id="overview-tab" data-toggle="tab" href="#overview" role="tab" aria-controls="overview" aria-selected="true">Quick Overview</a>
        </li>
        {% if results.network %}
        <li class="nav-item">
            <a class="nav-link" id="network-tab" data-toggle="tab" href="#network" role="tab" aria-controls="network" aria-selected="false">Network Analysis</a>
        </li>
        {% endif %}
        {% if results.behavior %}
        <li class="nav-item">
            <a class="nav-link" id="behavior-tab" data-toggle="tab" href="#behavior" role="tab" aria-controls="behavior" aria-selected="false">Behavioral Analysis</a>
        </li>
        {% endif %}
        {% if results.dropped %}
        <li class="nav-item">
            <a class="nav-link" id="dropped-tab" data-toggle="tab" href="#dropped" role="tab" aria-controls="dropped" aria-selected="false">Dropped Files ({{ results.dropped|length }})</a>
        </li>
        {% endif %}
        {% if results.CAPE and results.CAPE.payloads %}
        <li class="nav-item">
            <a class="nav-link" id="payloads-tab" data-toggle="tab" href="#payloads" role="tab" aria-controls="payloads" aria-selected="false">Payloads ({{ results.CAPE.payloads|length }})</a>
        </li>
        {% endif %}
        {% if results.procdump %}
        <li class="nav-item">
            <a class="nav-link" id="procdump-tab" data-toggle="tab" href="#procdump" role="tab" aria-controls="procdump" aria-selected="false">Process Dumps ({{ results.procdump|length }})</a>
        </li>
        {% endif %}
        {% if results.memory %}
        <li class="nav-item">
            <a class="nav-link" id="memory-tab" data-toggle="tab" href="#memory" role="tab" aria-controls="memory" aria-selected="false">Memory Analysis</a>
        </li>
        {% endif %}
    </ul>

    <div class="tab-content" id="reportTabsContent">
        <!-- Overview Tab -->
        <div class="tab-pane fade show active" id="overview" role="tabpanel" aria-labelledby="overview-tab">
            <br>
            {% include "analysis/sections/info.html" %}
            {% include "analysis/sections/errors.html" %}
            
            {% if results.info.category == "file" or results.info.category == "pcap" or results.info.category == "static" %}
                {% include "analysis/sections/file.html" %}
            {% elif results.info.category == "url" %}
                {% include "analysis/sections/url.html" %}
            {% endif %}
            
            {% include "analysis/sections/signatures.html" %}
            {% include "analysis/sections/screenshots.html" %}
        </div>

        <!-- Network Tab -->
        {% if results.network %}
        <div class="tab-pane fade" id="network" role="tabpanel" aria-labelledby="network-tab">
            <br>
            {% include "analysis/sections/network.html" %}
        </div>
        {% endif %}

        <!-- Behavior Tab -->
        {% if results.behavior %}
        <div class="tab-pane fade" id="behavior" role="tabpanel" aria-labelledby="behavior-tab">
            <br>
            {% include "analysis/sections/behavior.html" %}
        </div>
        {% endif %}

        <!-- Dropped Tab -->
        {% if results.dropped %}
        <div class="tab-pane fade" id="dropped" role="tabpanel" aria-labelledby="dropped-tab">
            <br>
            {% include "analysis/sections/dropped.html" %}
        </div>
        {% endif %}

        <!-- Payloads Tab -->
        {% if results.CAPE and results.CAPE.payloads %}
        <div class="tab-pane fade" id="payloads" role="tabpanel" aria-labelledby="payloads-tab">
            <br>
            {% include "analysis/sections/payloads.html" %}
        </div>
        {% endif %}

        <!-- Procdump Tab -->
        {% if results.procdump %}
        <div class="tab-pane fade" id="procdump" role="tabpanel" aria-labelledby="procdump-tab">
            <br>
            <section id="procdump_section">
                <div class="section-title">
                    <h4>Process Dumps</h4>
                </div>
                {% for file in results.procdump %}
                    <div>
                        <h4><a href="javascript:showHide('procdump_{{loop.index}}');">{{file.name}}</a></h4>
                        <div id="procdump_{{loop.index}}" style="display: none;">
                        {% include "analysis/generic/_file_info.html" %}
                        </div>
                    </div>
                {% endfor %}
            </section>
        </div>
        {% endif %}

        <!-- Memory Tab -->
        {% if results.memory %}
        <div class="tab-pane fade" id="memory" role="tabpanel" aria-labelledby="memory-tab">
            <br>
            {% include "analysis/sections/volatility.html" %}
        </div>
        {% endif %}

    </div>
</div>
{% endblock %}