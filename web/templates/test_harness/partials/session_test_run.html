<div class="card shadow-sm mb-3 border-0" id="run-card-{{ run.id }}">
    <div class="card-header bg-dark text-white d-flex justify-content-between align-items-center py-3">
        <div>
            <h5 class="mb-0 text-uppercase tracking-wider">
                <i class="fas fa-flask me-2 text-info"></i>{{ run.test_definition.name }}
            </h5>
            <small class="text-info opacity-75">{{ run.test_definition.description }} | Package: {{ run.test_definition.package }}</small>
        </div>

        <div class="d-flex align-items-center">

            <div class="d-flex flex-column align-items-center px-3 border-end border-secondary border-opacity-25" style="min-width: 100px;">
                <div class="tech-label text-uppercase mb-1">
                    Task
                </div>

                <div class="tech-value">
                    {% if cape_task %}
                    <a href="/analysis/{{cape_task.id}}" class="tech-link">
                        #{{ cape_task.id }}<span class="task-status-tag text-muted">{{ cape_task.status|upper }}</span>
                    </a>
                    {% else %}
                    <span class="text-muted opacity-50">NONE</span>
                    {% endif %}
                </div>
            </div>

            <div class="d-flex flex-column align-items-center pe-3 border-start border-secondary">todo request</div>
            <div class="d-flex flex-column align-items-center pe-3 border-start border-secondary ps-3">todo logs</div>

            <div style="min-width: 100px;" class="d-flex flex-column align-items-center pe-3 border-start border-secondary ps-3">
                <div class="tech-label text-uppercase mb-1">
                    Test #{{ run.id }}
                </div>

                {% if run.status == "unqueued" %}
                <span class="badge rounded-pill bg-secondary text-white-50 pt-2 pb-md-1">Not Queued</span>
                {% elif run.status == "queued" %}
                <span class="badge rounded-pill border border-info text-info pb-md-1">
                    <i class="fas fa-hourglass-start me-1"></i>Queued
                </span>
                {% elif run.status == "running" %}

                {% if cape_task.status == "completed" %}
                    <span class="badge rounded-pill bg-primary pt-2 pb-md-1">
                        <i class="fas fa-circle-notch fa-spin me-1"></i>Awaiting Report
                    </span>
                {% else %}
                    <span class="badge rounded-pill bg-primary pt-2 pb-md-1">
                        <i class="fas fa-circle-notch fa-spin me-1"></i>Running
                    </span>
                {% endif %}
                {% elif run.status == "complete" %}
                <span class="badge rounded-pill bg-success pt-2 pb-md-1">
                    <i class="fas fa-check-circle me-1"></i>Complete
                </span>
                {% elif run.status == "failed" %}
                <span class="badge rounded-pill bg-danger pt-2 pb-md-1">
                    <i class="fas fa-times-circle me-1"></i>Failed
                </span>
                {% else %}
                <span class="badge rounded-pill bg-warning text-dark pt-2 pb-md-1">
                    {{run.status}}
                </span>
                {% endif %}
            </div>

            {% if run.status == "unqueued" %}
            <div class="border-start border-secondary ps-3">
                <button class="btn btn-sm btn-outline-info px-3 me-3 shadow-sm hover-elevate" onclick="queue_run(this, '{{session.id}}', '{{run.id}}')">
                    <i class="fas fa-play me-1"></i>Queue
                </button>
            </div>
            {% elif run.status == "queued" %}
            <div class="border-start border-secondary ps-3">
                <button class="btn btn-sm btn-outline-danger px-3 me-3 shadow-sm hover-elevate" onclick="unqueue_run(this, '{{session.id}}', '{{run.id}}')">
                    <i class="fas fa-stop me-1"></i>Dequeue
                </button>
            </div>
            {% endif %}

        </div>
    </div>

    <div class="card-header bg-dark text-muted d-flex justify-content-between">
        <div>
            Requirement
        </div>
        <div class="d-flex align-items-center" style="margin-right: 135px;">
            Evaluation
        </div>
    </div>

    <div class="table-responsive">
        <div class="list-group list-group-flush border-top border-secondary">
            {% for obj in run.objectives %}
                {% if not obj.parent_id %}
                <div class="list-group-item bg-dark border-secondary py-1">
                    {% include "test_harness/partials/objective_item.html" with obj=obj %}
                </div>
                {% endif %}
            {% endfor %}
        </div>
    </div>
</div>